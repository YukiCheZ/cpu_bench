# metadata.yaml for esbuild benchmark
name: esbuild_benchmark
type: macrobenchmark
language: Go
setup: source setup.go
domain:
  - compiler
  - javascript
  - bundler
  - web_development
  - rendering

workloads:
  - name: esbuild_ThreeJS
    description: >
      Benchmark the performance of Three.js, a 3D graphics library, by
      rendering a complex JavaScript scene. Measures rendering time, 
      and efficiency of the graphics pipeline.
    data: 
      command: python3 generate_data.py --lang js
      parameters:
        size:
          description: Number of files to generate
          default: 500
        complexity:
          description: Complexity of each file
          default: 2000
        out:
          description: Output directory for generated files
          default: ./data/demo_js
        repeat-imports:
          description: Number of times to repeat imports in each file
          default: 10
        heavy-factor:
          description: Additional heavy factor per file
          default: 50
    command: go run main.go --bench ThreeJS 
    parameters:
      bin:
        description: Path to esbuild binary (or set ESBUILD_BIN env var)
        default: ./bin/esbuild
      src:
        description: Path to JavaScript/TypeScript source to bundle
        default: ./data/demo_js
      threads:
        description: Number of threads to use (sets GOMAXPROCS for esbuild process)
        default: 1
      iters:
        description: Number of iterations to run
        default: 30
  
  - name: esbuild_RomeTS
    description: >
      Benchmark RomeTS, a TypeScript/JavaScript bundler and compiler, by
      compiling a full TypeScript project.
    data: 
      command: python3 generate_data.py --lang ts
      parameters:
        size:
          description: Number of files to generate
          default: 500
        complexity:
          description: Complexity of each file
          default: 2000
        out:
          description: Output directory for generated files
          default: ./data/demo_js
        repeat-imports:
          description: Number of times to repeat imports in each file
          default: 10
        heavy-factor:
          description: Additional heavy factor per file
          default: 50
    command: go run main.go --bench RomeTS
    parameters:
      bin:
        description: Path to esbuild binary (or set ESBUILD_BIN env var)
        default: ./bin/esbuild
      src:
        description: Path to JavaScript/TypeScript source to bundle
        default: ./data/demo_js
      threads:
        description: Number of threads to use (sets GOMAXPROCS for esbuild process)
        default: 1
      iters:  
        description: Number of iterations to run
        default: 30
    
characteristics:
  IO_effects: medium
  single_machine: true
  network_effects: none
  cpu_bound: true
  memory_intensive: medium
  storage_intensive: low

tags:
  - cpu
  - compiler
  - javascript
  - bundler
  - esbuild
  - minify
  - sourcemap

dependencies:
  go: "1.24.5"
