name: guava_benchmark
type: macrobenchmark
language: Java
domain:
  - software_development

setup:
  command: ./scripts/setup.sh

# Updated workloads aligned with new runner (BenchmarkRunner) and script (run_benchmark.sh)
workloads:
  - name: guava_event
    summary: event stream aggregation and frequency analysis
    action: aggregate events and compute top-k statistics
    description: >
      Simulate a high-throughput event stream processing pipeline using Guava collections.
      Maintain a sliding window of events with LinkedHashMultimap and track user frequency with HashMultiset.
      Compute category hash signatures and extract top-K hot users to evaluate the performance of hashing and aggregation operations.
    command: ./scripts/run_benchmark.sh --workload event
    parameters:
      workload:
        description: Fixed workload identifier
        default: event
      dataSize:
        description: Number of events generated (controls window & users)
        default: 200000   
      threads:
        description: Parallel worker threads
        default: 1
      iterations:
        description: Per-thread iterations (batches processed)
        default: 100000
      warmupIterations:
        description: Optional warmup iteration count (override heuristic)
        default: 5
      noWarmup:
        description: Disable warmup when present
        default: false

  - name: guava_graph
    summary: directed graph traversal and topological sorting
    action: perform BFS, topological sort, and cycle detection
    description: >
      Construct a directed graph using Guava's GraphBuilder and populate it with nodes and edges.
      Execute multiple graph algorithms including Breadth-First Search (BFS), topological sorting via Kahn's algorithm, and Depth-First Search (DFS) based cycle detection to measure graph traversal efficiency.
    command: ./scripts/run_benchmark.sh --workload graph
    parameters:
      workload:
        description: Fixed workload identifier
        default: graph
      dataSize:
        description: Logical size factor (affects nodeCount ~ dataSize/50)
        default: 400000  
      threads:
        description: Parallel worker threads
        default: 1
      iterations:
        description: Per-thread iterations (full traversal cycles)
        default: 15000 
      warmupIterations:
        description: Optional warmup iteration count
        default: 5
      noWarmup:
        description: Disable warmup when present
        default: false

  - name: guava_bloom
    summary: Bloom filter insertion and probabilistic membership testing
    action: insert and query elements in a Bloom filter
    description: >
      Initialize a Guava BloomFilter and simulate a stream of integer insertions and membership queries.
      Perform additional chained hashing operations using SHA-256 and Murmur3 during processing to stress CPU integer arithmetic and bitwise operations alongside probabilistic data structure manipulation.
    command: ./scripts/run_benchmark.sh --workload bloom
    parameters:
      workload:
        description: Fixed workload identifier
        default: bloom
      dataSize:
        description: Number of operations per iteration (also drives expected insertions)
        default: 400000 
      threads:
        description: Parallel worker threads
        default: 1
      iterations:
        description: Per-thread iterations
        default: 2000 
      warmupIterations:
        description: Optional warmup iteration count
        default: 5
      noWarmup:
        description: Disable warmup when present
        default: false

  - name: guava_cache
    summary: concurrent cache simulation with hot-cold access patterns
    action: simulate concurrent cache access and eviction
    description: >
      Simulate a concurrent caching system with a skewed hot/cold key access pattern.
      Compute complex hash-based values for cache misses using Murmur3 and manage cache size through random eviction, evaluating the performance of concurrent map operations and hash computation under load.
    command: ./scripts/run_benchmark.sh --workload cache
    parameters:
      workload:
        description: Fixed workload identifier
        default: cache
      dataSize:
        description: Keys accessed per iteration
        default: 100000 
      threads:
        description: Parallel worker threads
        default: 1
      iterations:
        description: Per-thread iterations
        default: 1000
      warmupIterations:
        description: Optional warmup iteration count
        default: 5
      noWarmup:
        description: Disable warmup when present
        default: false

  - name: guava_immutable
    summary: immutable collection snapshotting and set operations
    action: create and manipulate immutable list and set snapshots
    description: >
      Generate immutable snapshots of data using Guava's ImmutableList and ImmutableSet.
      Perform set theoretic operations such as intersection and difference between snapshots, combined with hashing reductions, to measure the overhead of creating and querying immutable collection views.
    command: ./scripts/run_benchmark.sh --workload immutable
    parameters:
      workload:
        description: Fixed workload identifier
        default: immutable
      dataSize:
        description: Size of base int array
        default: 400000 
      threads:
        description: Parallel worker threads
        default: 1
      iterations:
        description: Per-thread iterations
        default: 33000
      warmupIterations:
        description: Optional warmup iteration count
        default: 5
      noWarmup:
        description: Disable warmup when present
        default: false

characteristics:
  IO_effects: low        # Pure in-memory computations
  single_machine: true
  network_effects: false
  memory_bound: low   # Uses sizable arrays/maps but aims to limit peak footprint

tags:
  - java
  - guava
  - collections
  - hashing
  - cache
  - graph
  - bloomfilter

dependencies:
  java: ">=11"
  guava: "33.4.8-jre"
