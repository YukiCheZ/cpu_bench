# metadata.yaml for FFmpeg CPU Multi-operation Benchmark
name: ffmpeg_benchmark
type: macrobenchmark:rate
language: C
domain:
  - multimedia
  - video_processing

setup:
  command: ./setup.sh
  parameters:
    compiler:
      description: C compiler to use for building FFmpeg
      default: gcc
    opt:
      description: Optimization level for compiler
      default: -O3

workloads:
  - name: ffmpeg
    summary: FFmpeg video processing and filtering benchmark
    action: apply complex video filters and transformations
    description: >
      Execute a CPU-intensive video processing pipeline using FFmpeg to transform input video streams.
      Apply a complex filter chain including scaling, Gaussian blur, unsharp masking, and frame blending to stress test CPU multimedia extensions.
      Process video frames in parallel instances pinned to specific CPU cores to evaluate multi-core scaling and floating-point performance.
    data:
      command: python3 generate_data.py
      parameters:
        output: 
          description: Path to the output video file
          default: data/test.mp4
        resolution:
          description: Resolution of the generated video (width x height)
          default: 1280x720
        duration:
          description: Duration of the generated video in seconds
          default: 480
        framerate:
          description: Frame rate of the generated video
          default: 10
        ffmpeg_bin:
          description: Path to ffmpeg executable
          default: ./bin/ffmpeg_install/bin/ffmpeg
    command: python3 run_benchmark.py
    parameters:
      input:
        description: Path to the input video file
        default: data/test.mp4
      threads:
        description: Number of threads used for CPU processing
        default: 1
      scale:
        description: Output video resolution (width:height)
        default: 1920:1080
      fps:
        description: Output frame rate
        default: 160
      ffmpeg_bin:
        description: Path to ffmpeg executable 
        default: ./bin/ffmpeg_install/bin/ffmpeg

characteristics:
  IO_effects: low
  single_machine: true
  network_effects: none
  cpu_bound: true
  memory_intensive: low

tags:
  - video
  - multimedia
  - encoding
  - decoding
  - filter

dependencies:
  python: ">=3.8"
  ffmpeg: ">=6.1"
