# metadata.yaml for FFmpeg CPU Multi-operation Benchmark
name: ffmpeg_benchmark
type: macrobenchmark:rate
language: C
domain:
  - multimedia
  - video_processing

setup:
  command: ./setup.sh
  parameters:
    compiler:
      full_name: compiler
      description: C compiler to use for building FFmpeg
      default: gcc
    opt:
      full_name: optimization level
      description: Optimization level for compiler
      default: -O3

workloads:
  - name: ffmpeg
    summary: FFmpeg video processing and filtering benchmark
    action: apply complex video filters and transformations
    description: >
      Execute a CPU-intensive video processing pipeline using FFmpeg to transform input video streams.
      Apply a complex filter chain including scaling, Gaussian blur, unsharp masking, and frame blending to stress test CPU multimedia extensions.
      Process video frames in parallel instances pinned to specific CPU cores to evaluate multi-core scaling and floating-point performance.
    data:
      command: python3 generate_data.py
      parameters:
        output: 
          full_name: output file
          description: Path to the output video file
          default: data/test.mp4
        resolution:
          full_name: resolution
          description: Resolution of the generated video
          default: 1280x720
        duration:
          full_name: duration
          description: Duration of the generated video in seconds
          default: 480
        framerate:
          full_name: frame rate
          description: Frame rate of the generated video
          default: 10
        ffmpeg_bin:
          full_name: ffmpeg binary path
          description: Path to ffmpeg executable
          default: ./bin/ffmpeg_install/bin/ffmpeg
    command: python3 run_benchmark.py
    parameters:
      input:
        full_name: input file
        description: Path to the input video file
        default: data/test.mp4
      threads:
        full_name: threads
        description: Number of threads used for CPU processing
        default: 1
      scale:
        full_name: scale resolution
        description: Output video resolution
        default: 1920:1080
      fps:
        full_name: output frame rate
        description: Output frame rate
        default: 160
      ffmpeg_bin:
        full_name: ffmpeg binary path
        description: Path to ffmpeg executable 
        default: ./bin/ffmpeg_install/bin/ffmpeg

characteristics:
  IO_effects: low
  single_machine: true
  network_effects: none
  cpu_bound: true
  memory_intensive: low

tags:
  - video
  - multimedia
  - encoding
  - decoding
  - filter

dependencies:
  python: ">=3.8"
  ffmpeg: ">=6.1"
