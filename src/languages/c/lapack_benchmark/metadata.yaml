# metadata.yaml for LAPACK CPU Benchmark
name: lapack_benchmark
type: microbenchmark
language: C
domain:
  - linear_algebra
  - scientific_computing

setup:
  command: ./setup.sh
  parameters:
    compiler:
      full_name: compiler
      description: Compiler to use
      default: gcc
    opt:
      full_name: optimization level
      description: Optimization level
      default: -O3

workloads:
  - name: lapack_solve
    summary: LAPACK linear system solver benchmark
    action: solve systems of linear equations using LU factorization
    description: >
      Generate a dense, diagonally dominant square matrix and a corresponding right-hand side vector.
      Execute the LAPACK `dgesv` routine to compute the solution to the system of linear equations using LU factorization.
      Measure the computational throughput of the solver to evaluate CPU floating-point performance in linear algebra tasks.
    command: ./bin/lapack_benchmark --mode solve
    parameters:
      size:
        full_name: matrix size
        description: Size of the matrix
        default: 2048
      iters:
        full_name: iterations
        description: Number of iterations to run
        default: 1500
      warmup:
        full_name: warmup iterations
        description: Number of warmup iterations
        default: 1
      threads:
        full_name: threads
        description: Number of concurrent threads to use
        default: 1
      seed:
        full_name: random seed
        description: Seed for random number generation
        default: 42

  - name: lapack_eigen
    summary: LAPACK symmetric eigenvalue decomposition benchmark
    action: compute eigenvalues and eigenvectors of symmetric matrices
    description: >
      Construct a random real symmetric matrix to serve as input for spectral analysis.
      Perform the LAPACK `dsyev` routine to calculate all eigenvalues and eigenvectors using iterative numerical algorithms.
      Assess the CPU's capability in handling symmetric matrix decompositions and floating-point intensive spectral computations.
    command: ./bin/lapack_benchmark --mode eigen
    parameters:
      size:
        full_name: matrix size
        description: Size of the matrix
        default: 2048
      iters:
        full_name: iterations
        description: Number of iterations to run
        default: 6
      warmup:
        full_name: warmup iterations
        description: Number of warmup iterations
        default: 1
      threads:
        full_name: threads
        description: Number of concurrent threads to use
        default: 1
      seed:
        full_name: random seed
        description: Seed for random number generation
        default: 42

  - name: lapack_svd
    summary: LAPACK singular value decomposition benchmark
    action: perform singular value decomposition on dense matrices
    description: >
      Initialize a general dense matrix with random floating-point values.
      Execute the LAPACK `dgesvd` routine to factorize the matrix into left and right singular vectors and singular values.
      Evaluate the performance of computationally intensive matrix factorization algorithms and memory access patterns during SVD computation.
    command: ./bin/lapack_benchmark --mode svd
    parameters:
      size:
        full_name: matrix size
        description: Size of the matrix
        default: 2048
      iters:
        full_name: iterations
        description: Number of iterations to run
        default: 3
      warmup:
        full_name: warmup iterations
        description: Number of warmup iterations
        default: 1 
      threads:
        full_name: threads
        description: Number of concurrent threads to use
        default: 1
      seed:
        full_name: random seed
        description: Seed for random number generation
        default: 42

characteristics:
  IO_effects: low
  single_machine: true
  network_effects: none
  cpu_bound: true
  memory_intensive: medium

tags:
  - linear_algebra
  - scientific_computing
  - lapack

dependencies:
  python: ">=3.8"
  lapack: "liblapacke-dev"
  blas: "libblas-dev"
  lapacke: "liblapack-dev"
  make: ">=4.0"
