# metadata.yaml for LAPACK CPU Benchmark
name: lapack_cpu_benchmark
type: microbenchmark
language: C
domain:
  - linear_algebra
  - scientific_computing

workloads:
  - name: lapack_solve
    description: >
      Benchmark for solving linear systems using LAPACK.
    setup:
      command: make
      parameters:
        CC:
          description: Compiler to use (gcc or clang)
          default: gcc
        OPT:
          description: Optimization level (O0, O1, O2, O3, Ofast)
          default: O3
    data:
      command: python3 generate_data.py
      parameters:
        size:
          description: Size of the matrix (number of rows/columns)
          default: 2000
        mode:
          description: Type of matrix data to generate: solve, eigen, svd
          default: solve
        output_dir:
          description: Path to the output data directory
          default: ./data
    run:
      command: ./bin/lapack_benchmark --mode solve
      parameters:
        size:
          description: Size of the matrix (number of rows/columns)
          default: 2000
        threads:
          description: Number of concurrent threads to use
          default: 1
        iters:
          description: Number of iterations to run
          default: 3
        warmup:
          description: Number of warmup iterations
          default: 1

  - name: lapack_eigen
    description: >
      Benchmark for computing eigenvalues and eigenvectors using LAPACK.
    setup:
      command: make
      parameters:
        CC:
          description: Compiler to use (gcc or clang)
          default: gcc
        OPT:
          description: Optimization level (O0, O1, O2, O3, Ofast)
          default: O3
    data:
      command: python3 generate_data.py
      parameters:
        size:
          description: Size of the matrix (number of rows/columns)
          default: 2000
        mode:
          description: Type of matrix data to generate: solve, eigen, svd
          default: solve
        output_dir:
          description: Path to the output data directory
          default: ./data
    run:
      command: ./bin/lapack_benchmark --mode eigen
      parameters:
        size:
          description: Size of the matrix (number of rows/columns)
          default: 2000
        threads:
          description: Number of concurrent threads to use
          default: 1
        iters:
          description: Number of iterations to run
          default: 3
        warmup:
          description: Number of warmup iterations
          default: 1

  - name: lapack_svd
    description: >
      Benchmark for computing singular value decomposition using LAPACK.
    setup:
      command: make
      parameters:
        CC:
          description: Compiler to use (gcc or clang)
          default: gcc
        OPT:
          description: Optimization level (O0, O1, O2, O3, Ofast)
          default: O3
    data:
      command: python3 generate_data.py
      parameters:
        size:
          description: Size of the matrix (number of rows/columns)
          default: 2000
        mode:
          description: Type of matrix data to generate: solve, eigen, svd
          default: solve
        output_dir:
          description: Path to the output data directory
          default: ./data
    run:
      command: ./bin/lapack_benchmark --mode svd
      parameters:
        size:
          description: Size of the matrix (number of rows/columns)
          default: 2000
        threads:
          description: Number of concurrent threads to use
          default: 1
        iters:
          description: Number of iterations to run
          default: 3
        warmup:
          description: Number of warmup iterations
          default: 1

characteristics:
  IO_effects: low
  single_machine: true
  network_effects: none
  cpu_bound: true
  memory_intensive: medium

tags:
  - linear_algebra
  - scientific_computing
  - lapack
  - multithreaded
  - svd
  - eigen
  - solve

dependencies:
  python: ">=3.8"
  lapack: "liblapacke-dev"
  blas: "libblas-dev"
  lapacke: "liblapack-dev"
  make: ">=4.0"
