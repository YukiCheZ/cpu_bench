# metadata.yaml for Redis CPU Benchmark
name: redis_benchmark
type: macrobenchmark      
language: C               
domain:                     
  - database
  - memory

setup:
  command: ./setup.sh
  parameters:
    compiler:
      full_name: compiler
      description: Compiler to use for building Redis
      default: gcc 
    opt:
      full_name: optimization level
      description: Optimization level for compiler
      default: -O3

workloads:
  - name: redis-benchmark
    summary: Redis in-memory database performance benchmark
    action: execute concurrent requests against Redis instances
    description: >
      Launch multiple independent Redis server instances to fully utilize available CPU cores.
      Execute the `redis-benchmark` tool to generate high-throughput traffic with concurrent clients and pipelined requests.
      Measure the request processing throughput and latency to evaluate the CPU's integer performance and memory subsystem efficiency.
    command: python3 run_benchmark.py
    parameters:
      clients:
        full_name: concurrent clients
        description: Number of concurrent clients sending requests
        default: 100
      threads:
        full_name: threads
        description: Number of threads used by redis-benchmark
        default: 2
      requests:
        full_name: total requests
        description: Total number of requests per iteration
        default: 4000000
      datasize:
        full_name: data size
        description: Size of each value
        unit: bytes
        default: 16
      pipeline:
        full_name: pipeline size
        description: Number of requests to pipeline
        default: 1

characteristics:
  IO_effects: minimal          
  single_machine: true         
  network_effects: minimal     

tags:
  - concurrency
  - pipeline

dependencies:
  redis-server: ">=7.0"
  redis-benchmark: ">=7.0"
  python: ">=3.6"  
