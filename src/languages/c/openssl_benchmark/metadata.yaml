# metadata.yaml for OpenSSL CPU Benchmark
name: openssl_cpu_benchmark
type: macrobenchmark
language: C
domain:
  - cryptography

setup:
  command: ./setup.sh
  parameters:
    compiler:
      full_name: compiler
      description: Compiler to use
      default: gcc
    opt:
      full_name: optimization level
      description: Optimization level
      default: -O3

workloads:
  - name: openssl
    summary: OpenSSL encryption and hashing performance benchmark
    action: perform AES encryption and SHA hashing operations
    description: >
      Load a pre-generated data file into memory to serve as the payload.
      Execute a continuous loop of AES-256-CBC encryption followed by SHA-256 hashing of the ciphertext.
      Perform AES-256-CBC decryption and SHA-512 hashing of the result to verify data integrity and measure CPU cryptographic throughput.
    data:
      command: python3 generate_data.py
      parameters:
        size:
          full_name: data size
          description: Size of the data file to generate
          default: 50
        output:
          full_name: output file
          description: Path to the output data file
          default: ./data/data.bin
    command: ./bin/openssl_benchmark
    parameters:
      input:
        full_name: input file
        description: Path to the pre-generated data file
        default: ./data/data.bin
      threads:
        full_name: threads
        description: Number of concurrent threads to use
        default: 1
      iters:
        full_name: iterations
        description: Number of iterations to run
        default: 3000
      warmup:
        full_name: warmup iterations
        description: Number of warmup iterations
        default: 3

characteristics:
  IO_effects: low
  single_machine: true
  network_effects: none
  cpu_bound: true
  memory_intensive: low

tags:
  - cryptography
  - openssl
  - encryption
  - sha
  - multithreaded

dependencies:
  python: ">=3.8"
  openssl: "libssl-dev"
