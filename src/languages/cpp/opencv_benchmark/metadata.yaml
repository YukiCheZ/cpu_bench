# metadata.yaml for OpenCV CPU Benchmark
name: opencv_benchmark
type: microbenchmark
language: C++
domain:
  - computer_vision
  - image_processing

setup:
  command: ./setup.sh
  parameters:
    compiler:
      description: Compiler to use (gcc or clang)
      default: gcc
    opt:
      description: Optimization level (O0, O1, O2, O3)
      default: -O3

workloads:
  - name: fft_batch
    description: Batch FFT transform (10x DFT passes)
    command: ./bin/opencv_benchmark --workload fft_batch
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 1024
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 50
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: conv_heavy
    description: Deep convolution stack (15 Gaussian layers)
    command: ./bin/opencv_benchmark --workload conv_heavy
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 1024
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 25
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2
  
  - name: mandelbrot
    description: Mandelbrot fractal computation (float-intensive)
    command: ./bin/opencv_benchmark --workload mandelbrot
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 1024
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 40
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: jacobi
    description: 2D Jacobi iteration (Poisson PDE simulation)
    command: ./bin/opencv_benchmark --workload jacobi
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 2048
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 400
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: canny
    description: Edge detection baseline (Canny algorithm)
    command: ./bin/opencv_benchmark --workload canny
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 2048
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 150
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: optical_flow
    description: Dense optical flow estimation (Farneback)
    command: ./bin/opencv_benchmark --workload optical_flow
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 1024
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 50
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: motion_blur
    description: Motion blur convolution kernel
    command: ./bin/opencv_benchmark --workload motion_blur
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 2048
      images:
        description: Number of images to process per iteration
        default: 50
      iters:
        description: Number of timing iterations
        default: 40
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: background_sub
    description: Background subtraction (MOG2 model)
    command: ./bin/opencv_benchmark --workload background_sub
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 1080
      images:
        description: Number of images to process per iteration
        default: 100
      iters:
        description: Number of timing iterations
        default: 50
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2
  
  - name: color_tracking
    description: HSV color threshold + morphology
    command: ./bin/opencv_benchmark --workload color_tracking
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 2160
      images:
        description: Number of images to process per iteration
        default: 100
      iters:
        description: Number of timing iterations
        default: 200
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2

  - name: feature_match
    description: ORB feature detection and matching
    command: ./bin/opencv_benchmark --workload feature_match
    parameters:
      size:
        description: Width/Height of square images
        unit: pixels
        default: 1024
      images:
        description: Number of images to process per iteration
        default: 100
      iters:
        description: Number of timing iterations
        default: 120
      threads:
        description: Number of parallel threads
        default: 1
      warmup:
        description: Number of warmup iterations to run before timing
      default: 2
  

characteristics:
  IO_effects: minimal
  single_machine: true
  network_effects: false
  memory_bound: true
  cpu_bound: true

tags:
  - filtering
  - convolution
  - linear_algebra
  - histogram

dependencies:
  opencv: ">=4.0"
  c++: ">=17"
